<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> A tale of three leaf models | Code, Maps, and More </title> <meta name="author" content="Keenan Ganz"> <meta name="description" content="Different ways of modeling the temperature of leaves"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8C%8E&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://s-kganz.github.io/blog/2023/leaf-temperature/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="//"> Code, Maps, and More </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">A tale of three leaf models</h1> <p class="post-meta"> Created in June 29, 2023 </p> <p class="post-tags"> <a href="//blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>The temperature of a plant’s leaves is a really interesting parameter. Temperature is influenced by both things happening inside the plant (photosynthesis, respiration, etc.) and also the environment the plant is in (air temperature, humidity, downwelling radiation, etc.). In general, under constant environmental conditions a warmer plant is unhappier than a cooler plant. Healthy leaves are photosynthesizing and evaporating water. Evaporating water cools the leaf, so if that process is disrupted for some reason the leaf will warm up. If we measure a leaf’s temperature, we can have a general idea of whether the plant is happily photosynthesizing or experiencing some form of stress. But, here’s the problem. Outside of the laboratory, environmental conditions are never constant.</p> <p>When we measure a leaf’s temperature, how do we know whether that temperature is a good or a bad sign in that plant’s environment? A <a href="https://www.sciencedirect.com/science/article/pii/S0168192323002514" rel="external nofollow noopener" target="_blank">paper just came</a> out that uses flux tower data to answer this question, and I think the authors’ approach is worth focusing on. To understand why, let’s take a look at models of leaf temperature through time.</p> <h1 id="approach-1-empirical-models">Approach 1: Empirical models</h1> <p>The use of leaf temperature to model plants finds its roots in the 1980s. A group from the US Water Conservation Laboratory used the Penman-Monteith equation, an evapotranspiration model, to model water stress with leaf temperature. They developed an index called the crop water stress index (CWSI). Conceptually, the CWSI compared how much a leaf transpired compared to the maximum rate under the observed conditions.</p> <p>Unfortunately, the analytical version of this index was a little gnarly to calculate.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cwsi_analytic-480.webp 480w,/assets/img/cwsi_analytic-800.webp 800w,/assets/img/cwsi_analytic-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/cwsi_analytic.png" class="img-fluid z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>So, the same year that <a href="https://onlinelibrary.wiley.com/doi/abs/10.1029/WR017i004p01133" rel="external nofollow noopener" target="_blank">the original CWSI paper</a> was published, the same group came out with <a href="https://www.sciencedirect.com/science/article/pii/0002157181900327" rel="external nofollow noopener" target="_blank">an empirical version</a> that could be deployed in crop fields.</p> <p>This new version of the CWSI was much easier to use, but required more setup. Instead of modeling the maximum transpiration rate, the empirical CWSI compared the temperature of a given leaf to well-watered and water-stressed control plants. If the temperature of your field was closer to the water-stressed control, you could say that your crops are water stressed. And, if the temperature of the field was close to the well-watered control, you wcould say that your crops are not water stressed.</p> <p>The empirical CWSI has since been studied in dozens of plants with consistent success. Produce you eat may have been irrigated using guidance from a CWSI monitoring system. But, what if we work in a natural system where we cannot manipulate some plants to be stressed and others well-watered? In this case, we again have to turn to modeling.</p> <h1 id="approach-2-leaf-level-model">Approach 2: Leaf-level model</h1> <p>The second major approach to modeling leaf temperature is to consider the physics of heat transfer at the leaf level. These models generally assume energy balance, that is, the amount of energy entering a leaf is the same as the amount of energy exiting a leaf. The model will use a series of equations to describe heat transfer in the leaf which can then be solved for leaf temperature.</p> <p>A recent example of such an energy balance model is described in <a href="https://doi.org/10.1007/s11284-011-0905-5" rel="external nofollow noopener" target="_blank">Okajima et al. (2012)</a> and implemented in the R package <code class="language-plaintext highlighter-rouge">tealeaves</code>. I’ve also written <a href="http://ganzk.shinyapps.io/shiny_tealeaves" rel="external nofollow noopener" target="_blank">a Shiny application</a> to interact with the model.</p> <p>Although energy balance models have a sound physical basis, they require parameters that are difficult to measure. For example, the model implemented in <code class="language-plaintext highlighter-rouge">tealeaves</code> represents the transpiration rate of the leaf through two parameters: stomatal conductance and cuticular conductance. If I want to know the temperature of a non-transpiring leaf, I can simply set both conductances to zero. But, what about a rapidly transpiring leaf? It isn’t clear how one would model this scenario. Set both conductances to infinity? Look up reasonable values in the literature?</p> <p>Another drawback is that the mathematical complexity of energy balance models makes them slow to calculate. Leaf temperature appears in multiple places in the model, so one must solve the system numerically. For lightweight modeling work this doesn’t matter too much. But, if I want to implement an energy balance model with remote sensing data, I quickly run into scaling issues.</p> <h1 id="approach-3-flux-tower-model">Approach 3: Flux tower model</h1> <p><a href="https://www.sciencedirect.com/science/article/pii/S0168192323002514" rel="external nofollow noopener" target="_blank">A recent paper in Agricultural and Forest Meteorology</a> presents an energy balance model derived from flux tower data. This model doesn’t have to be solved numerically (mostly), provides clear endmembers to represent stressed and unstressed leaves, and so far has excellent correspondence with measured leaf temperatures.</p> <p>Here is the model’s parameterization of leaf temperature.</p> \[T_L = T_a + \frac{Q_a r_H}{k \rho c_p}(1-f_E)\] <p>\(T_L\) is leaf temperature, \(T_a\) is air temperature, \(Q_a\) is net radiation, \(r_H\) is resistance to sensible heat transfer, \(k\) is the sidedness of the leaf, \(\rho\) is air density, \(c_p\) is heat capacity, and \(f_E\) is the “evaporative fraction”, or the proportion of \(Q_a\) that is dissipated by transpiration.</p> <p>The first thing to note is that this is very easy to calculate from flux tower data. \(Q_a\) corresponds to <code class="language-plaintext highlighter-rouge">NETRAD</code> in Ameriflux data products, and the resistance, density, and heat capacity parameters are easily approximated from meteorological data. We don’t have to consider leaf-level characteristics because these are all buried in the flux measurements that go into calculating <code class="language-plaintext highlighter-rouge">NETRAD</code>. I was able to reimplement this model in R and reproduce figures in the paper in about a day.</p> <p>The more important note is that \(f_E\) gives us a clear way to model stressed and unstressed plants with very few assumptions about leaf characteristics. When \(f_E = 0\), leaves are not transpiring at all. When \(f_E = 1\), leaves are transpiring about as fast as energy balance allows. One caveat is that if we manipulate \(f_E\), we have to calculate \(Q_a\) manually and end up solving the model numerically.</p> <p>The authors tested their model by comparing the modeled leaf temperature with measured canopy temperature from the flux tower (<code class="language-plaintext highlighter-rouge">T_CANOPY</code> in Ameriflux). The authors report good correspondence in their study sites in Arizona, which appear to only have one radiometer measuring canopy temperature on each tower.</p> <p>I was curious how this model would perform somewhere with a more complex canopy. So, I applied this model to flux data from Wind River Experimental Forest (US-xWR). This flux tower is great because it has six radiometers measuring canopy temperature along a vertical profile. If we recreate Figure 2 from the paper on data from the top and bottom of Wind River’s canopy, we also get pretty good correspondence.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/wref_kibler_eb_test-480.webp 480w,/assets/img/wref_kibler_eb_test-800.webp 800w,/assets/img/wref_kibler_eb_test-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/wref_kibler_eb_test.png" class="img-fluid z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>It seems like this approach overestimates leaf temperature in the upper canopy, but underestimates in the lower canopy. Overall, not bad at all. Since the <code class="language-plaintext highlighter-rouge">NETRAD</code> measurements come from the top of the canopy, it makes sense that we would have a slightly better model there. Also, this is a very back-of-the-envelope plot. For example, I’m not filtering to observations where the latent heat flux is transpiration-only.</p> <p>In summary, I think this new model for flux tower data is super cool. It works out of the box with flux tower data, is easy to calculate, lends itself well to modeling stressed plants, and seems to perform well in different environments. Bravo to the original authors!</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Keenan Ganz. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: February 23, 2026. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>